# Batch Processing Options

## AWS Batch

AWS Batch is a fully managed batch computing service that plans, schedules, and runs containerized batch ML, simulation, and analytics workloads across the full range of AWS compute offerings, such as Amazon ECS, Amazon EKS, AWS Fargate, and Spot or On-Demand Instances.

## Azure Batch

Azure Batch creates and manages a pool of compute nodes (virtual machines), installs the applications we want to run, and schedules jobs to run on the nodes. 

| Feature                        | AWS Batch                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Azure Batch                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Programmatically scale up/down | AWS Batch on AWS EKS orchestration scales up and down nodes managed by AWS Batch and run pods on those nodes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Azure Batch can automatically scale pools based on parameters that you define.                                                                                                                                                                                                                                                              |
| Ease of maintainability        | AWS Batch is simple to set up and schedule.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Azure Batch is simple to set up and schedule.                                                                                                                                                                                                                                                                                               |
| Auditability                   | AWS Batch is integrated with AWS CloudTrail, a service that provides a record of actions taken by a user, role, or an AWS service in AWS Batch. CloudTrail captures all API calls for AWS Batch as events. AWS Artifact can also be used.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | The Azure Monitor service collects and aggregates metrics and logs from every component of the system. Azure Monitor provides a view of availability, performance, and resilience, with issue notification. Resource logs in Batch must be enabled.                                                                                         |
| Security                       | requests must be signed by using an access key ID and a secret access key that is associated with an IAM principal or AWS STS can be used to generate short-term credentials.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Azure holds a list of best practises and baselines for Azure Batch to rely on. [https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/batch-security-baseline?toc=%2Fazure%2Fbatch%2FTOC.json](https://learn.microsoft.com/en-us/security/benchmark/azure/baselines/batch-security-baseline?toc=%2Fazure%2Fbatch%2FTOC.json) |
| Throughput                     | Dependent on allocation of resources.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Dependent on allocation of resources.                                                                                                                                                                                                                                                                                                       |
| Observability                  | AWS Batch can be monitored via CloudWatch and CloudTrail                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | The Azure Monitor service collects and aggregates metrics and logs from every component of the system. Azure Monitor provides a view of availability, performance, and resilience, with issue notification. Resource logs in Batch must be enabled.                                                                                         |
| Cost                           | Dependent on resources used (i.e., Fargate spot capacity). 

<br>Within eu-west-1:

##### Pricing calculations

I've selected running the task once a day, using one vCPU with 2GB of memory. This will help us calculate the exact cost once we understand the needed capacity.

<br>

Number of tasks or pods: 1 per day \* (730 hours in a month / 24 hours in a day) = 30.42 per month

30.42 tasks x 1 vCPU x 1 hours x 0.04656 USD per hour = 1.42 USD for vCPU hours

30.42 tasks x 2.00 GB x 1 hours x 0.00511 USD per GB per hour = 0.31 USD for GB hours

20 GB - 20 GB (no additional charge) = 0.00 GB billable ephemeral storage per task

<br>

Minimum, **1.73 USD / Month** | Within UK South, using similar metrics to AWS Batch:

<br>

Single Core, 1Gb RAM, 20Gb temporary storage: **$0.022**/hour

<br>

This brings us to around 0.66924 USD / Month.                                                                                                                                                              |